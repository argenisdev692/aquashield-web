---
import '../styles/global.css';
import InspectionModal from '../components/InspectionModal.astro';
import CookieBanner from '../components/CookieBanner.astro';

interface Props {
  title?: string;
  description?: string;
  image?: string;
  canonicalURL?: string;
}

const {
  title = "AquaShield Restoration LLC | Total Restoration & Protection",
  description = "Professional water damage restoration and protection services. 24/7 emergency response, insurance claims assistance, mold remediation, and structural drying. Serving your community with trust and expertise.",
  image = "/og-image.jpg",
  canonicalURL = Astro.url.href,
} = Astro.props;

// Company data - centralized for easy updates
const companyData = {
  name: "AquaShield Restoration LLC",
  tagline: "Total Restoration & Protection",
  phone: "(713) 587-6423",
  emergencyPhone: "(713) 587-6423",
  email: "info@aquashieldrestorationusa.com",
  address: {
    street: "3733 Westheimer Rd. Ste 1 #4583",
    city: "Houston",
    state: "TX",
    zip: "77027",
  },
  social: {
    facebook: "https://facebook.com/aquashieldrestorationusa",
    instagram: "https://instagram.com/aquashieldrestorationusa",
    twitter: "https://twitter.com/aquashieldrest",
    linkedin: "https://linkedin.com/company/aquashieldrestorationusa",
  },
};
---

<!doctype html>
<html lang="en" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content={Astro.generator} />
    
    <!-- Primary Meta Tags -->
    <title>{title}</title>
    <meta name="title" content={title} />
    <meta name="description" content={description} />
    <meta name="keywords" content="water damage restoration, emergency water removal, flood damage repair, mold remediation, structural drying, insurance claims assistance, water damage repair, restoration services, 24/7 emergency service" />
    <meta name="robots" content="index, follow" />
    <meta name="author" content={companyData.name} />
    
    <!-- Canonical URL -->
    <link rel="canonical" href={canonicalURL} />
    
    <!-- Favicon and App Manifest -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg?v=2" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png?v=2" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png?v=2" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png?v=2" />
    <link rel="manifest" href="/site.webmanifest" />
    <meta name="theme-color" content="#0C2340" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content={canonicalURL} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={Astro.site ? new URL(image, Astro.site).href : image} />
    <meta property="og:site_name" content={companyData.name} />
    <meta property="og:locale" content="en_US" />
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content={canonicalURL} />
    <meta property="twitter:title" content={title} />
    <meta property="twitter:description" content={description} />
    <meta property="twitter:image" content={Astro.site ? new URL(image, Astro.site).href : image} />
    
    <!-- Preconnect to external resources for faster loading -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" />
    
    <!-- Preload critical fonts - Roboto Regular 400 (most used) -->
    <link
      rel="preload"
      as="style"
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap"
      rel="stylesheet"
      media="print"
      onload="this.media='all'"
    />
    <noscript>
      <link
        href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap"
        rel="stylesheet"
      />
    </noscript>
    
    <!-- Alpine.js - defer for non-blocking -->
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" as="script" />
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    
    <!-- Global Utilities - Inline for immediate availability -->
    <script src="/utils.js" is:inline></script>
    
    <!-- Google Analytics 4 -->
    {import.meta.env.PUBLIC_GOOGLE_ANALYTICS_ID && (
      <>
        <script async src={`https://www.googletagmanager.com/gtag/js?id=${import.meta.env.PUBLIC_GOOGLE_ANALYTICS_ID}`}></script>
        <script is:inline define:vars={{ gaId: import.meta.env.PUBLIC_GOOGLE_ANALYTICS_ID }}>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', gaId);
        </script>
      </>
    )}
    
    <!-- Schema.org Structured Data -->
    <script type="application/ld+json" set:html={JSON.stringify({
      "@context": "https://schema.org",
      "@type": "LocalBusiness",
      "@id": canonicalURL,
      "name": companyData.name,
      "description": description,
      "url": canonicalURL,
      "telephone": companyData.phone,
      "email": companyData.email,
      "address": {
        "@type": "PostalAddress",
        "streetAddress": companyData.address.street,
        "addressLocality": companyData.address.city,
        "addressRegion": companyData.address.state,
        "postalCode": companyData.address.zip,
        "addressCountry": "US"
      },
      "sameAs": [
        companyData.social.facebook,
        companyData.social.instagram,
        companyData.social.twitter,
        companyData.social.linkedin
      ],
      "openingHours": "Mo-Su 00:00-23:59",
      "priceRange": "$$",
      "image": Astro.site ? new URL(image, Astro.site).toString() : image,
      "serviceArea": {
        "@type": "GeoCircle",
        "geoMidpoint": {
          "@type": "GeoCoordinates",
          "latitude": "0",
          "longitude": "0"
        },
        "geoRadius": "50000"
      },
      "hasOfferCatalog": {
        "@type": "OfferCatalog",
        "name": "Water Damage Restoration Services",
        "itemListElement": [
          {
            "@type": "Offer",
            "itemOffered": {
              "@type": "Service",
              "name": "Water Damage Restoration",
              "description": "Complete water damage restoration services including extraction, drying, and repair"
            }
          },
          {
            "@type": "Offer",
            "itemOffered": {
              "@type": "Service",
              "name": "Emergency Response",
              "description": "24/7 emergency water damage response services"
            }
          },
          {
            "@type": "Offer",
            "itemOffered": {
              "@type": "Service",
              "name": "Mold Remediation",
              "description": "Professional mold inspection, removal, and prevention services"
            }
          },
          {
            "@type": "Offer",
            "itemOffered": {
              "@type": "Service",
              "name": "Insurance Claims Assistance",
              "description": "Help navigating insurance claims for water damage restoration"
            }
          },
          {
            "@type": "Offer",
            "itemOffered": {
              "@type": "Service",
              "name": "Structural Drying",
              "description": "Industrial-grade structural drying and dehumidification services"
            }
          }
        ]
      }
    })} />
    
    <!-- Global Styles -->
    <style is:global>
      /* Smooth scrolling */
      html {
        scroll-behavior: smooth;
      }

      /* Selection color */
      ::selection {
        background-color: var(--aqua);
        color: var(--white);
      }

      /* Focus visible for accessibility */
      :focus-visible {
        outline: 2px solid var(--aqua);
        outline-offset: 2px;
      }

      /* Reduce motion for accessibility */
      @media (prefers-reduced-motion: reduce) {
        *,
        *::before,
        *::after {
          animation-duration: 0.01ms !important;
          animation-iteration-count: 1 !important;
          transition-duration: 0.01ms !important;
          scroll-behavior: auto !important;
        }
      }

    </style>
  </head>
  <body class="min-h-screen bg-background text-foreground antialiased">
    <slot />
    
    <!-- Inspection Modal -->
    <InspectionModal />
    
    <!-- Cookie Consent Banner -->
    <CookieBanner />
    
    <!-- Intersection Observer for fade-in animations -->
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const observerOptions = {
          root: null,
          rootMargin: '0px',
          threshold: 0.1
        };

        const observer = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              entry.target.classList.add('is-visible');
            }
          });
        }, observerOptions);

        document.querySelectorAll('.fade-in-section').forEach((section) => {
          observer.observe(section);
        });
      });
    </script>
  </body>
</html>
